<html lang="en">

<head>
  <meta charset="UTF-8">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QDNV2WFQB7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());
  
      gtag('config', 'G-QDNV2WFQB7');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>title</title>
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Mr+Dafoe">
  <link type="text/css" href="/dynamic/css/materialize.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link type="text/css" href="/dynamic/css/style-light.full.css" rel="stylesheet">
  <link href="//db.onlinewebfonts.com/c/50eafd25cbb5f88fe7bb5cc77421bb49?family=Freestyle+Script" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="/dynamic/js/materialize.min.js"></script>
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/290e6d3280.js" crossorigin="anonymous"></script>
  <link rel="apple-touch-icon" href="/dynamic/img/icons/icons-96x96.png">
  <meta name="apple-mobile-web-app-status-bae" content="#aa7700">
  <meta name="theme-color" content="#FFE1C4">
  <script src="https://s3.amazonaws.com/stitch-sdks/js/bundles/4.6.0/stitch.js"></script>

  <script>

    // const { Stitch, RemoteMongoClient, UserPasswordCredential, getProviderClient, getAuthProviderRoute, UserPasswordAuthProviderClient } = stitch;
    const client = stitch.Stitch.initializeDefaultAppClient('testapplication-zhxbq');


  </script>

</head>

<body>

  <script>

    function logoutFunction() {
      client.auth.logout().then(function () {
        location = self.location;
      });
    };
  </script>

  <!-- top nav -->
  <header>
    <nav class="nav-wrapper z-depth-0">
      <div class="container">
        <a id="title-text" class="navBarColour" href="/">Stratiphy</a>
        <a href="#" class="sidenav-trigger right grey-text text-darken-1" data-target="side-menu">
          <i class="material-icons navBarColour">menu</i>
        </a>
        <!-- desktop menu  -->
        <ul class="right hide-on-med-and-down">
          <!-- <li><a href="#" class="tooltipped btn-floating btn-small indigo darken-4" data-tooltip="Instagram">
                    <i class="fab fa-instagram"></i>
                </a></li>
                <li><a href="#" class="tooltipped btn-floating btn-small indigo darken-4" data-tooltip="Facebook">
                    <i class="fab fa-facebook"></i>
                </a></li>
                <li><a href="#" class="tooltipped btn-floating btn-small indigo darken-4" data-tooltip="Twitter">
                    <i class="fab fa-twitter"></i>
                </a></li> -->
          <!-- <li><a href="/dynamic/pages/strategies.html" class="waves-effect">My Strategies</a></li> -->
          <li><a href="#strategy-types" class="waves-effect">About</a></li>
          <li><a href="#products" class="waves-effect">Products</a></li>
          <script>
            if (client.auth.isLoggedIn) {
              document.write(`
                    <li><a href="/dynamic/pages/strategies.html" class="waves-effect">My Strategies</a></li>
                    <li><a href='javascript:logoutFunction()'>Logout</a></li>`);
            } else {
              document.write("<li><a href='/dynamic/pages/login.html'>Login / Register</a></li>");
            }
          </script>
          <!-- <li><a href="/dynamic/pages/login.html">Login</a></li> -->
          <li><a href="/dynamic/pages/contact.html" class="waves-effect"></li>
          <!-- <li><a href="#" class="btn-floating indigo darken-4 z-depth-0">
                    <i class="material-icons">notifications</i>
                </a></li>
                <li><span class="badge white-text pink new">5</span></li> -->
        </ul>
        <!-- mobile menu  -->
        <ul class="sidenav" id="side-menu">
          <li><a class="subheader">STRATIPHY</a></li>
          <li><a href="/index.html" class="waves-effect">Home</a></li>
          <li><a href="/dynamic/pages/about.html" class="waves-effect">About</a></li>
          <!-- <li><a href="/dynamic/pages/strategies.html" class="waves-effect">My Strategies</a></li> -->
          <script>
            if (client.auth.isLoggedIn) {
              document.write(`
                    <li><a href="/dynamic/pages/strategies.html" class="waves-effect">My Strategies</a></li>
                    <li><a href='javascript:logoutFunction()'>Logout</a></li>`);
            } else {
              document.write("<li><a href='/dynamic/pages/login.html'>Login / Register</a></li>");
            }
          </script>
          <li>
            <div class="divider"></div>
          </li>
          <li><a href="/dynamic/pages/contact.html" class="waves-effect">
              <i class="material-icons">mail_outline</i>Contact</a>
          </li>
        </ul>
      </div>
    </nav>
  </header>

  <script>
    const formResetPassword = document.querySelector('form-reset-password');

    function resetPasswordFunction() {
      // Parse the URL query parameters
      // const client = stitch.Stitch.initializeDefaultAppClient('testapplication-zhxbq');

      const url = window.location.search;
      const params = new URLSearchParams(url);

      const token = params.get('token');
      const tokenId = params.get('tokenId');
      const newPassword = document.getElementById("newPassword").value;
      // formResetPassword.newPassword.value; //    getUserInputFromPage();

      // Confirm the user's email/password account
      const emailPassClient = client.auth
        .getProviderClient(stitch.UserPasswordAuthProviderClient.factory);

      emailPassClient.resetPassword(token, tokenId, newPassword).then(() => {
        console.log("Successfully reset password!");
        alert("Please log in with the new password to complete the password reset.")
        window.location.replace("/index.html");
      }).catch(err => {
        console.log("Error resetting password:", err);
      });
    }
  </script>

  <body class="grey lighten-4">

    <!-- form for user pwd  -->
    <div class="container" style="margin-top: 50px;">
      <!-- <p id="resetText"></p>Enter a new password here: -->
      <div id="form-reset-password" class="row">
        <!-- <form-reset-password class="sign-in container section"> -->
          <!-- <h6>Log in</h6> -->
          <!-- <div class="divider"></div> -->
          <div class="input-field">
            <input placeholder="" id="newPassword" type="password" class="validate">
            <label for="newPassword">New Password</label>
          </div>
          <p>
            <label>
              <input type="checkbox"  onclick="showPassword()"/>
              <span>Show Password</span>
            </label>
          </p>
          <div class="input-field center">
            <button class="btn-small" id="resetPwd-btn" onclick="resetPasswordFunction()">Reset</button>
          </div>
        <!-- </form-reset-password> -->
      </div>
    </div>
    

  </body>

  <script>
        function showPassword() {
        var x = document.getElementById("newPassword");
        if (x.type === "password") {
            x.type = "text";
        } else {
            x.type = "password";
        }
    }
  </script>

<script>
  $(document).ready(function () {
    $('.sidenav').sidenav({ edge: "right" });
  })
</script>

</html>